(()=>{function e(e,t,i,a,s,d){this.id=(new Date).getTime(),this.title=e,this.description=t,this.date=i,this.priority=a,this.finished=d||!1,this.projectName=s}const t={today:{},thisWeek:{}};function i(e,i){t[e]||(t[e]={}),t[e][i.id]=i}let a;const s=document.getElementById("today"),d=document.getElementById("thisWeek"),n=document.getElementById("addProjBtn"),c=document.getElementById("projectModal"),l=document.getElementById("submitProject"),o=document.getElementById("projForm"),r=document.getElementById("projName"),m=document.getElementById("projContainer"),v=document.getElementById("addTaskBtn"),u=document.getElementById("descriptionBlock"),p=document.getElementById("overlay"),y=document.getElementById("addTaskForm"),h=document.getElementById("submitTask"),k=document.getElementById("editTask"),L=document.getElementById("form"),E=document.getElementById("title"),g=document.getElementById("description"),f=document.getElementById("date"),B=document.getElementById("tasksGrid"),T=document.getElementsByName("priority");function I(){y.classList.remove("active"),p.classList.remove("active"),c.classList.remove("active"),u.classList.remove("active"),h.classList.remove("active"),k.classList.remove("active"),a=void 0}function N(e,t,i,a){let s=document.createElement(e);return i&&(s.src=i),a&&(s.id=a),t&&t.forEach((e=>{s.classList.add(e)})),s}function j(e,i,s,d,n,c){let l=N("div",["task",d]),o=N("div",["task_checkbox"]),r=N("input",[i]);r.type="checkbox",r.name=i,r.checked=n,n&&l.classList.add("checked"),r.addEventListener("change",(()=>{r.checked?(l.classList.add("checked"),t[B.className][r.name].finished=!0):(l.classList.remove("checked"),t[B.className][r.name].finished=!1)}));let m=N("div",["task_title"]);m.innerText=i;let v=N("div",["description"]),h=N("button",void 0,void 0,"descBtn");h.addEventListener("click",(()=>{u.innerHTML="";const e=function(e,t,i,a){const s=N("div",["descriptionBlock"]),d=N("p");d.innerText=`Task title: ${e}`;const n=N("p");n.innerText=`Task description: ${t}`;const c=N("p");c.innerText=`Task date: ${i}`;const l=N("p");return l.innerText=`Task is in project: ${a}`,s.append(d,n,c,l),s}(i,c,s,B.className);u.appendChild(e),u.classList.add("active")})),h.innerText="Description";let L=N("div",["task_date"]);L.innerText=s;let T=N("img",["edit"],"./images/pencil.svg");T.addEventListener("click",(()=>{p.classList.add("active"),y.classList.add("active"),E.value=i,g.value=c,f.value=s,document.getElementById(d).checked=!0,a=e,k.classList.add("active")}));let I=N("img",["delete"],"./images/bin.svg");I.addEventListener("click",(()=>{B.removeChild(l),delete t[B.className][e]})),B.appendChild(l),l.append(o,m,v,L,T,I),o.appendChild(r),v.appendChild(h)}s.addEventListener("click",(()=>{B.classList.contains("today")||(B.innerHTML="",B.className="today",C("today"))})),d.addEventListener("click",(()=>{B.classList.contains("thisWeek")||(B.innerHTML="",B.className="thisWeek",C("thisWeek"))})),v.addEventListener("click",(()=>{p.classList.add("active"),y.classList.add("active"),h.classList.add("active")})),p.addEventListener("click",(e=>{e.target===p&&(I(),L.reset())})),u.addEventListener("click",(e=>{e.target===u&&I()})),h.addEventListener("click",(t=>{if(t.preventDefault(),""===E.value)return void E.setCustomValidity("Please fill out the task name field");let a;for(let e=0;e<T.length;e++)T[e].checked&&(a=T[e].value);let s=new e(E.value,g.value,f.value,a,B.className);i(B.className,s),j(s.id,E.value,f.value,a,!1,g.value),L.reset(),I()})),n.addEventListener("click",(()=>{p.classList.add("active"),c.classList.add("active")})),l.addEventListener("click",(e=>(e.preventDefault(),""===r.value?(r.setCustomValidity("Please fill out the project name field"),void r.reportValidity()):t[r.value]?(r.setCustomValidity("There is already a project with this name. Please use another name for your project"),void r.reportValidity()):(t[r.value]={},function(e){let t=document.createElement("p");t.innerText=e,t.className="projectsNames",t.addEventListener("click",(()=>{B.classList.contains(e)||(B.innerHTML="",B.className=e,C(e))})),m.append(t)}(r.value),o.reset(),void I())))),k.addEventListener("click",(e=>{if(e.preventDefault(),""===E.value)return void E.setCustomValidity("Please fill out the task name field");let i;for(let e=0;e<T.length;e++)T[e].checked&&(i=T[e].value);t[B.className][a]={title:E.value,description:g.value,date:f.value,priority:i,projectName:B.className},B.innerHTML="",C(B.className),L.reset(),I()}));let x=new e("work","everyday","2023-02-02","high","today");function C(e){const i=Object.values(t[e]);for(let e=0;e<i.length;e++)j(i[e].id,i[e].title,i[e].date,i[e].priority,i[e].finished)}i("today",x),j(x.id,x.title,x.date,x.priority,x.finished,x.description),localStorage.setItem("myItems",JSON.stringify(t))})();