(()=>{function e(e,t,i,s,a,n){this.id=(new Date).getTime(),this.title=e,this.description=t,this.date=i,this.priority=s,this.finished=n||!1,this.projectName=a}const t=JSON.parse(localStorage.getItem("myItems"));let i;console.log(t);const s=document.getElementById("today"),a=document.getElementById("thisWeek"),n=document.getElementById("addProjBtn"),d=document.getElementById("projectModal"),c=document.getElementById("submitProject"),l=document.getElementById("projForm"),o=document.getElementById("projName"),r=document.getElementById("projContainer"),m=document.getElementById("addTaskBtn"),v=document.getElementById("descriptionBlock"),u=document.getElementById("overlay"),p=document.getElementById("addTaskForm"),y=document.getElementById("submitTask"),k=document.getElementById("editTask"),g=document.getElementById("form"),h=document.getElementById("title"),L=document.getElementById("description"),E=document.getElementById("date"),f=document.getElementById("tasksGrid"),I=document.getElementsByName("priority");function B(e,t,i,s){let a=document.createElement(e);return i&&(a.src=i),s&&(a.id=s),t&&t.forEach((e=>{a.classList.add(e)})),a}function N(){p.classList.remove("active"),u.classList.remove("active"),d.classList.remove("active"),v.classList.remove("active"),y.classList.remove("active"),k.classList.remove("active"),i=void 0}function T(e,s,a,n,d,c){let l=B("div",["task",n]),o=B("div",["task_checkbox"]),r=B("input",[s]);r.type="checkbox",r.name=s,r.checked=d,d&&l.classList.add("checked"),r.addEventListener("change",(()=>{r.checked?(l.classList.add("checked"),t[f.className][e].finished=!0):(l.classList.remove("checked"),t[f.className][e].finished=!1)}));let m=B("div",["task_title"]);m.innerText=s;let y=B("div",["description"]),g=B("button",void 0,void 0,"descBtn");g.addEventListener("click",(()=>{v.innerHTML="";const e=function(e,t,i,s){const a=B("div",["descriptionBlock"]),n=B("p");n.innerText=`Task title: ${e}`;const d=B("p");d.innerText=`Task description: ${t}`;const c=B("p");c.innerText=`Task date: ${i}`;const l=B("p");return l.innerText=`Task is in project: ${s}`,a.append(n,d,c,l),a}(s,c,a,f.className);v.appendChild(e),v.classList.add("active")})),g.innerText="Description";let I=B("div",["task_date"]);I.innerText=a;let N=B("img",["edit"],"./images/pencil.svg");N.addEventListener("click",(()=>{u.classList.add("active"),p.classList.add("active"),h.value=s,L.value=c,E.value=a,document.getElementById(n).checked=!0,console.log(e),i=e,k.classList.add("active"),console.log(t)}));let T=B("img",["delete"],"./images/bin.svg");T.addEventListener("click",(()=>{f.removeChild(l),delete t[f.className][e]})),f.appendChild(l),l.append(o,m,y,I,N,T),o.appendChild(r),y.appendChild(g)}function j(e){let t=document.createElement("p");t.innerText=e,t.className="projectsNames",t.addEventListener("click",(()=>{f.classList.contains(e)||(f.innerHTML="",f.className=e,x(e))})),r.append(t)}function x(e){const i=Object.values(t[e]);for(let e=0;e<i.length;e++)T(i[e].id,i[e].title,i[e].date,i[e].priority,i[e].finished)}s.addEventListener("click",(()=>{f.classList.contains("today")||(f.innerHTML="",f.className="today",x("today"))})),a.addEventListener("click",(()=>{f.classList.contains("thisWeek")||(f.innerHTML="",f.className="thisWeek",x("thisWeek"))})),m.addEventListener("click",(()=>{u.classList.add("active"),p.classList.add("active"),y.classList.add("active")})),u.addEventListener("click",(e=>{e.target===u&&(N(),g.reset())})),v.addEventListener("click",(e=>{e.target===v&&N()})),y.addEventListener("click",(i=>{if(i.preventDefault(),""===h.value)return void h.setCustomValidity("Please fill out the task name field");let s;for(let e=0;e<I.length;e++)I[e].checked&&(s=I[e].value);let a=new e(h.value,L.value,E.value,s,f.className);var n,d;n=f.className,d=a,t[n]||(t[n]={}),t[n][d.id]=d,T(a.id,h.value,E.value,s,!1,L.value),g.reset(),N(),localStorage.setItem("myItems",JSON.stringify(t))})),n.addEventListener("click",(()=>{u.classList.add("active"),d.classList.add("active")})),c.addEventListener("click",(e=>(e.preventDefault(),""===o.value?(o.setCustomValidity("Please fill out the project name field"),void o.reportValidity()):t[o.value]?(o.setCustomValidity("There is already a project with this name. Please use another name for your project"),void o.reportValidity()):(t[o.value]={},j(o.value),l.reset(),N(),void localStorage.setItem("myItems",JSON.stringify(t)))))),k.addEventListener("click",(e=>{if(e.preventDefault(),""===h.value)return void h.setCustomValidity("Please fill out the task name field");let s;for(let e=0;e<I.length;e++)I[e].checked&&(s=I[e].value);t[f.className][i]={...t[f.className][i],title:h.value,description:L.value,date:E.value,priority:s,projectName:f.className},f.innerHTML="",x(f.className),g.reset(),N(),localStorage.setItem("myItems",JSON.stringify(t))})),Object.keys(t).forEach((e=>{"today"!==e&&"thisWeek"!==e&&j(e)})),x("today")})();